## 项目6：习惯追踪与复盘Agent

### 项目定位

一个通过每日对话记录习惯的助手。用户随时说一句话记录当天状态，系统自动积累，周末生成复盘报告和个性化建议。

### 核心技术点

| 技术点 | 说明 | 学习资源方向 |
|--------|------|--------------|
| 对话状态管理 | 跨session保持上下文 | 数据库存储对话历史 |
| 结构化信息提取 | 从自然语言提取数据 | LLM + JSON输出 |
| 时序数据分析 | 趋势识别、对比分析 | Pandas基础 |
| 报告生成 | 数据驱动的文本生成 | Prompt设计 |
| 长期记忆 | 记住历史模式以提供个性化建议 | 与项目5技术相通 |

### 系统架构

```
用户日常输入
（"今天跑了5公里"、"今天状态不太好"）
    │
    ▼
┌─────────────────┐
│  记录解析模块   │ ──→ 提取：日期、类别、数值、情绪
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  数据存储层     │ ──→ SQLite/JSON，按日期组织
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  分析与洞察     │ ──→ 趋势分析、模式发现、异常检测
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  报告生成Agent  │ ──→ 周报、月报、个性化建议
└─────────────────┘
```

### 功能模块设计

**模块1：每日记录**
- 输入方式：自然语言对话
- 示例：
  - "今天早起成功，6点半起床"
  - "今天没学习，状态很差"
  - "跑步5公里，感觉不错"
  - "今天情绪低落，可能是没睡好"
- 输出：确认记录成功 + 简单反馈

**模块2：信息提取**
- 将自然语言转为结构化数据
- 提取维度：
  - 类别：运动、学习、睡眠、情绪、饮食等
  - 数值：可量化的指标（时长、次数、评分）
  - 情绪标签：正面/中性/负面
  - 备注：额外信息

**模块3：即时查询**
- 示例：
  - "我这周运动了几次？"
  - "上次跑步是什么时候？"
  - "我最近睡眠怎么样？"

**模块4：周期性复盘**
- 自动触发或手动请求
- 生成内容：
  - 数据摘要（各维度统计）
  - 趋势分析（与上周对比）
  - 模式发现（"你通常周三状态不好"）
  - 改进建议（基于数据的个性化建议）

### 数据结构设计

```python
# 每日记录
{
    "date": "2026-01-10",
    "entries": [
        {
            "time": "08:30",
            "raw_input": "今天6点半起床，早起成功",
            "category": "睡眠",
            "metrics": {"wake_time": "06:30", "early_rise": true},
            "mood": "positive",
            "note": null
        },
        {
            "time": "20:00",
            "raw_input": "跑步5公里，感觉不错",
            "category": "运动",
            "metrics": {"type": "跑步", "distance_km": 5},
            "mood": "positive",
            "note": null
        }
    ]
}

# 周报数据
{
    "week": "2026-W02",
    "summary": {
        "运动": {"count": 4, "total_distance_km": 18},
        "睡眠": {"avg_wake_time": "07:15", "early_rise_rate": 0.6},
        "情绪": {"positive_rate": 0.7}
    },
    "comparison_to_last_week": {...},
    "patterns": ["周三状态容易低落", "运动后情绪普遍较好"],
    "suggestions": ["尝试周二晚早睡，改善周三状态"]
}
```

### 技术选型建议

| 组件 | 推荐方案 | 理由 |
|------|----------|------|
| 数据存储 | SQLite | 轻量、支持复杂查询 |
| LLM | Claude API / GPT-4 | 提取和生成都需要 |
| 数据分析 | Pandas | 灵活处理时序数据 |
| 可视化 | Matplotlib / Plotly | 报告中嵌入图表 |
| 前端 | Gradio | 对话+图表展示 |

### 开发步骤建议

1. **Day 1-2**：记录与提取
   - 设计数据结构和存储方案
   - 实现LLM信息提取（自然语言→结构化）
   - 测试各种输入格式

2. **Day 3-4**：查询功能
   - 实现基本统计查询
   - 支持多种问法的意图识别

3. **Day 5-6**：复盘报告
   - 实现数据聚合逻辑
   - 设计报告生成的Prompt
   - 加入简单可视化

4. **Day 7**：完善与优化
   - 优化对话体验
   - 加入个性化建议
   - 处理边界情况

### 教程可写的技术点

1. 用LLM做结构化信息提取
2. 对话式应用的状态管理
3. 时序数据的分析与可视化
4. 如何设计好的复盘报告Prompt

### 延伸方向

- 接入通知提醒（每晚提醒记录）
- 支持语音输入
- 与日历/待办应用集成
- 长期趋势分析（月报、季报）
- 结合项目5的知识库，关联学习记录

---

## 三个项目的时间安排建议

| 周次 | 项目 | 核心产出 |
|------|------|----------|
| 第1周 | 项目3：购物决策助手 | 多Agent协作基础、工具调用 |
| 第2周 | 项目5：知识管理助手 | 向量数据库、RAG检索 |
| 第3周 | 项目6：习惯追踪Agent | 结构化提取、时序分析 |

### 技术点渐进关系

```
项目3（多Agent协作）
    │
    │ 学会：Agent设计、状态管理、工具调用
    │
    ▼
项目5（记忆系统）
    │
    │ 学会：向量存储、检索策略、持久化
    │
    ▼
项目6（习惯追踪）
    │
    │ 综合运用：信息提取 + 存储 + 分析 + 生成
    │
    ▼
为论文的"异常诊断多Agent系统"打下技术基础
```
